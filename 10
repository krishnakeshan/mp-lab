DELAY  MACRO
LOCAL D1,D2

PUSH BX
PUSH CX
MOV BX,1000H
D1: MOV CX,0FFH
D2: LOOP D2
DEC BX
JNZ D1
POP CX
POP BX
ENDM

.MODEL SMALL
.DATA
 PORTC EQU 0E882H
 CTRL EQU 0E883H
 CLKSTEP DB 20H
 ACLKSTEP DB 40H

.CODE
 MOV AX,@DATA
 MOV DS,AX
 MOV AL,80H
 MOV DX,CTRL
 OUT DX,AL
 MOV AL,77H
 LOOP1: MOV DX,PORTC
        OUT DX,AL
        DELAY
        ROR AL,01
        DEC CLKSTEP
        JNZ LOOP1

 LOOP2: MOV DX,PORTC
        OUT DX,AL
        DELAY
        ROL AL,01
        DEC ACLKSTEP
        JNZ LOOP2
 EXIT: MOV AH,4CH
       INT 21H

 END
